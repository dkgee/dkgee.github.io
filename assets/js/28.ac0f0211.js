(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{656:function(s,a,n){"use strict";n.r(a);var e=n(36),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"kubernates-k8s"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubernates-k8s"}},[s._v("#")]),s._v(" Kubernates(K8S)")]),s._v(" "),a("p",[s._v("记录k8s一些学习方法、安装命令和脚本")]),s._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://github.com/dkgee/kubernetes-starter",target:"_blank",rel:"noopener noreferrer"}},[s._v("K8s课程资料仓库"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/istio/istio",target:"_blank",rel:"noopener noreferrer"}},[s._v("istio"),a("OutboundLink")],1),s._v("：K8s的连接、安全、控制和检测工具")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://developer.aliyun.com/article/715805?spm=a2c6h.12873639.0.0.29e220a12lxxqb",target:"_blank",rel:"noopener noreferrer"}},[s._v("容器服务-K8S知识图谱"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://docs.kubernetes.org.cn/115.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes中文社区 | 中文文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/pvmcDQ4fHM905NZSk5FVIg",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes Dashboard 及监控组件 Heapster 部署"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/kubeoperator/kubeoperator",target:"_blank",rel:"noopener noreferrer"}},[s._v("KubeOperator"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://feisky.gitbooks.io/kubernetes/content/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes指南"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/feiskyer/kubernetes-handbook",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes指南-Github"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://feisky.xyz/",target:"_blank",rel:"noopener noreferrer"}},[s._v("倪朋飞的博客-云计算领域"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzU0NjEwMTg4Mg==&mid=2247484111&idx=1&sn=0db3aaedd3f01f412704d45a6627633d&chksm=fb638ddacc1404cc9ba8af00cf031b96f5d4fe571cb1715bfbe4d2bd4768abd551e0fa4f9c40&mpshare=1&scene=1&srcid=&sharer_sharetime=1587479409949&sharer_shareid=c2b08c8381f1402bec291a6bcc99c5d0&key=d2a5d91993b95522ef942780fcf27a2273ba96e1c26196bb766ed5a5db37de817699b6ab0d26fe9ba1e54a3cf344fd2f870bc268b8b0f7b50ff33ca973e91f69549fc6c6b9b531973eb9750542e503aa&ascene=1&uin=NTkwMDY0OTAw&devicetype=Windows+7&version=62080079&lang=zh_CN&exportkey=Aa9cI3XFQAsanckWBiHpuf0%3D&pass_ticket=uzM%2BGgmt8agjfUjY0%2BLWt%2FhCujbKbvaGVxxN71%2F9EWXNF33Sr5vdjAwFEAGgCDzt",target:"_blank",rel:"noopener noreferrer"}},[s._v("kubernetes概述-介绍、组件、架构"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"k8s知识点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s知识点"}},[s._v("#")]),s._v(" k8s知识点")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("第二章 kubernetes简介\n第一节-k8s是什么？\n第二节k8s优点\n第三节-k8s功能\n第四节-k8s在日志管理系统的应用\n第五节-k8s在 Devops中的应用\n第六节-k8s在微服务中的应用\n第七节-k8s特点和功能总结\n第八节-k8s118+新增功能\n第九节-传统时代v容器时代部暑应用程序的对比分析\n\n第三章 kubernetes组件\n第一节- master节点组件 pserver\n第二节- master节点组件kube-scheduler\n第三节- master节点组件kube-controller-manager\n第四节- master节点组件etcd\n第五节- master节点组件 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n第六节- master节点组件kube-proxy\n第七节- master节点组件 calico\n第八节- master节点组件 corns\n第九节-node节点组件 kubelet\n第十节-node节点组件 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n第十一节-node节点组件 calico\n第十二节-附加组件k8 s dashboard\n第十三节-附加组件 Ingress controller\n第十四节-附加组件 prometheus+ alertmanager+ guarana\n第十五节-附加组件efk第十六节附加组件\n\n第四章 kubernetes API\n第一节API变更\n第二节- OpenMP介绍\n第三节-AP版本和AP组\n\n第五章 kubernetes架构\n第一节-结合架构图详解k8s架构\n\n第六章 kubernetes1.18多 master节点高可用集群安装\n初始化安装k8s集群的机器\n配置 firewall和 iptables防火墙\n配置 selinx和内核参数\n安装和配置 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n安装 keepalive\n初始化k8s集群\n安装caco组件\n在k8s中添加 master2和 master3节点\n在k8s中添加node节点\n测试 keepalive+lvs实现k8s的 master节点高可用\n安装k8s dashboard组件\n配置 dashboard的管理员权限\n安装 metrics-server组件\n\n第七章 kubernetes1.18单 master节点高可用集群安装\n安装配置docker\n安装k8s的maste节点组件\n安装k8s的node节点组件\n在k8s中添加node节点\n安装traefik组件\n安装k8s的dashboard组件\n安装metrics组件\nkubectl top命令讲解\n\n第八章 kubernetes命令行工具- kubectl\n第一节- kubectl简介\n第二节- kubect操作命令演示\n笫三节- kubectl输出选项\n第四节- kubot常用命令介绍\n\n第九章 容器讲解\n笫一节-容器概述\n笫二节-容器镜像\n第三节-私有镜像\n\n第十章 docker讲解\n第一节- docker优点和缺点\n第二节-配置 docker镜像加速器\n第三节- docke基本用法：和镜像相关的命令\n第四节- docker基本用法：和容器相关的命令\n第五节- docker.部署 nginx服务\n第六节-通过 dockerfile构建第一个nginx镜像\n第七节- dockerfile指令介绍\n第八节- dockerfile指令-CMD和 ENTRYPOINT\n第九节- dockerfile指令 VOLUME和 ONBUILD\n第十节1- ONBUILD用法演示\n第十一节- docker容器的数据持久化\n第十二节- docker的数据卷容器\n第十三节- docker数据备份和还原\n第十四节 docker部署 tomcat服务\n第十五节- docker网络\n第十六节- docker容器互联\n第十七节- docker容器隔离\n\n第十一章 kubernetes pod\n第一节-pod简介\n第二节-po是如何工作的？\n第三节- pod template模板介绍\n第四节-和pod相关的ap对象\n第五节-通过编写资源清单yam文件创建pod\n第六节-容器钧子 poststall和 preSto\n第七节-容器採针 livenessProbe和 Ireadinessprobe\n第八节-pod常见的状态和重启策略\n第九节-名称空间 namespace\n第十节-pod标签和标簦选择器\n第十一节- nodeselectori和 nodeName\n\n第十二章pod的高级使用\n第一节-容器存活性探测 livenessProbe讲解\n第二节-容器就绪性探测 readinessProbe讲解\n第三节- livenessProbe实践-演示使用exec探针\n第四节livenessProbe实践-演示使用httpget探针\n第五节-readinessProbe实践-演示使用httpget？探针\n第六节-pod生命周期 lifecycle- poststart和 presto\n第七节-测试 DostStart第八节-测试 preSto\n\n第十三章 pod控制器replicaset \nreplicase简介\n通过replicase管理pod\nreplicase实现原理\n\n第十四章 pod控制器 Deployment \nDeployment简介\n通过 Deployment管理pod\nDeployment控制器spec字段讲解\n\n第十五章 replicase和Deploymen区别\nreplicase和deployment区别\nreplicase和 deploymen联系\n\n第十六章 kubernetes "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n第一节- kubernetes service介绍\n第二节-测试通过 service访问pod\n第三节-创建type是 Nodeporti的 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n第四节-创建没有 selector的 servce\n第五节-创建tpe是 ExternalName的 servce\n第六节- headless service讲解\n第七节-创建type是 Load Balancer和 externally的 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n第八节- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" type汇总整理\n\n第十七章 kubernetes volume存储卷\n第一节- kubernetes volume介绍\n第二节- kubernetes volume- empty Dir\n第三节- kubernetes volume- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" Path\n第四节- kubernetes volume- nfs\n第五节- kubernetes volume-pvc\n第六节测试pvc和v绑定\n第七节-测试pod使用pvc存储卷\n第八节-测试pvc的 Retain回收策略\n\n第十八章pod控制器- daemons\n第一节- Daemonset简介\n第二节-通过 Daemonset'管理pod\n第三节- Daemons部害 fluent组件\n第四节-编写 Daemonset的资源清单文件\n\n第十九章pod高级调度-污点和容忍度\n第一节-污点和容忍度介绍\n第二节-tant和 toleration用法\n第三节-污点和容忍度应用场景\n第四节-测试污点和容忍度\n\n第二十章pod控制器 statefulset\n第一节- statefulset介绍和使用\n第二节-通过 statefulset创建pod\n第三节- statefulset卷申请模板 volume ClaimTemplate\n第四节- statefulset部罟和扩缩容\n第五节-编写 statefulset的资源清单yam文件\n\n第二十一章 storageclass\n第一节- storageclass介绍\n第二节- storageclassi通过n实现pv的动态供给\n第三节- statefulset通过存储类动态生成pv\n\n第二十二章 kubernetes认证、授权、准入控制\n第一节-k8s认证、授权、准入控制介绍\n第二节- token和 kubeconfig认证\n第三节-kBs的RBAC授权机制\n第四节-通过 token令牌登陆 dashboard\n第五节-通过 kubeconfig登陆 dashboard\n\n第二十三章 kubernets中部署EFK日志管理平台\nk8s中安装 elasticsearch组件\nk8s中安装 fluent组件\nk8s中安装 kiana组件\n配置 kiana界面-通过 kiana展示采集的日志数据\n\n第二十四章hem\n第一节-安装hem和 tiller\n第二节·测试hem部k8s应用\n第三节-hem部署 memcache\n第四节-hem部暑 rabbitry\n\n第二十五章在k8s中搭建 prometheus+ alertmanager +grafana全方位监控告警\n第一节- prometheus简介\n笫二节-安装nde- exporter组件\n第三节-在k8s中安装 prometheus：组件\n第四节-配置 prometheus热加载\n笫五节-在kBs中安装 grafana组件\n第六节- grafana导入 prometheus数据源\n第七节-在 grafana界面展示物理节点资源指标\n笫八节-在 guarana界面展示 docker.容器的资源指标\n第九节-安装kube- state-mecs组件\n第十节-在 grafana界面展示kBs资源指标\n第十一节-在k8s中安装 aletmanager组件\n第十二节-配置 alertmanager报警规则\n第十三节配置 alertmanager发送报警到qq邮箱\n第十四节-配置 alertmanager发送报警到钉钉\n第十五节-配置 alertmanager发送报警到微信\n第十六节-配置 alertmanager多途径报警\n\n第二十六章基于 jenkins和 kubernetes的 DevOps平台\n第一节- DevOps概述第二节-在kBs集群中安装 jenkins\n第三节- jenkins对接 kubernetes\n第四节- elkins配置 kubernetes的pod模板\n第五节-配置 jenkins的 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" hub凭据第六节- jenkins pipeline语法\n第七节-通过 pipeline部署k8s应用第八节-安装 jenkins的 BlueOcean插件\n第九节-通过 pipeline部署k8s应用到测试、开发、运维环境\n第十节-通过 pipeline实现k8s回滚\n\n第二十七章k8s对接ceph\n第一节-ceph块存储rbd介绍\n第二节-ceph文件系统存储 cephas介绍\n第三节-ceph对象存储 radosav介绍\n第四节-分布式存储的优点\n第五节-ceph核心组件介绍\n第六节-安装ceph集群\n第七节-添加 ceph osd\n第八节- ceph os扩容、缩容\n第九节-创建 ceph rbd\n第十节-安装对接ceph的 kubernetes集群\n第十一节- kubernetes对接 ceph rbd\n第十二节-测试pod挂载 ceph rbd\n第十三节-基于 ceph rbd生成pv\n第十四节- statefulset+ storageclass+cph最佳实践\n第十四节-基于 storageclass动态生成pw\n第十五节安装多 monitor的ceph集群\n第十六节-测试k8s对接ceph的多 monitor\n第十七节-ceph集群故障排查\n\n第二十八章 Ingress和 Ingress Controller\n\n第二十九章k8s中部署 Mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br"),a("span",{staticClass:"line-number"},[s._v("148")]),a("br"),a("span",{staticClass:"line-number"},[s._v("149")]),a("br"),a("span",{staticClass:"line-number"},[s._v("150")]),a("br"),a("span",{staticClass:"line-number"},[s._v("151")]),a("br"),a("span",{staticClass:"line-number"},[s._v("152")]),a("br"),a("span",{staticClass:"line-number"},[s._v("153")]),a("br"),a("span",{staticClass:"line-number"},[s._v("154")]),a("br"),a("span",{staticClass:"line-number"},[s._v("155")]),a("br"),a("span",{staticClass:"line-number"},[s._v("156")]),a("br"),a("span",{staticClass:"line-number"},[s._v("157")]),a("br"),a("span",{staticClass:"line-number"},[s._v("158")]),a("br"),a("span",{staticClass:"line-number"},[s._v("159")]),a("br"),a("span",{staticClass:"line-number"},[s._v("160")]),a("br"),a("span",{staticClass:"line-number"},[s._v("161")]),a("br"),a("span",{staticClass:"line-number"},[s._v("162")]),a("br"),a("span",{staticClass:"line-number"},[s._v("163")]),a("br"),a("span",{staticClass:"line-number"},[s._v("164")]),a("br"),a("span",{staticClass:"line-number"},[s._v("165")]),a("br"),a("span",{staticClass:"line-number"},[s._v("166")]),a("br"),a("span",{staticClass:"line-number"},[s._v("167")]),a("br"),a("span",{staticClass:"line-number"},[s._v("168")]),a("br"),a("span",{staticClass:"line-number"},[s._v("169")]),a("br"),a("span",{staticClass:"line-number"},[s._v("170")]),a("br"),a("span",{staticClass:"line-number"},[s._v("171")]),a("br"),a("span",{staticClass:"line-number"},[s._v("172")]),a("br"),a("span",{staticClass:"line-number"},[s._v("173")]),a("br"),a("span",{staticClass:"line-number"},[s._v("174")]),a("br"),a("span",{staticClass:"line-number"},[s._v("175")]),a("br"),a("span",{staticClass:"line-number"},[s._v("176")]),a("br"),a("span",{staticClass:"line-number"},[s._v("177")]),a("br"),a("span",{staticClass:"line-number"},[s._v("178")]),a("br"),a("span",{staticClass:"line-number"},[s._v("179")]),a("br"),a("span",{staticClass:"line-number"},[s._v("180")]),a("br"),a("span",{staticClass:"line-number"},[s._v("181")]),a("br"),a("span",{staticClass:"line-number"},[s._v("182")]),a("br"),a("span",{staticClass:"line-number"},[s._v("183")]),a("br"),a("span",{staticClass:"line-number"},[s._v("184")]),a("br"),a("span",{staticClass:"line-number"},[s._v("185")]),a("br"),a("span",{staticClass:"line-number"},[s._v("186")]),a("br"),a("span",{staticClass:"line-number"},[s._v("187")]),a("br"),a("span",{staticClass:"line-number"},[s._v("188")]),a("br"),a("span",{staticClass:"line-number"},[s._v("189")]),a("br"),a("span",{staticClass:"line-number"},[s._v("190")]),a("br"),a("span",{staticClass:"line-number"},[s._v("191")]),a("br"),a("span",{staticClass:"line-number"},[s._v("192")]),a("br"),a("span",{staticClass:"line-number"},[s._v("193")]),a("br"),a("span",{staticClass:"line-number"},[s._v("194")]),a("br"),a("span",{staticClass:"line-number"},[s._v("195")]),a("br"),a("span",{staticClass:"line-number"},[s._v("196")]),a("br"),a("span",{staticClass:"line-number"},[s._v("197")]),a("br"),a("span",{staticClass:"line-number"},[s._v("198")]),a("br"),a("span",{staticClass:"line-number"},[s._v("199")]),a("br"),a("span",{staticClass:"line-number"},[s._v("200")]),a("br"),a("span",{staticClass:"line-number"},[s._v("201")]),a("br"),a("span",{staticClass:"line-number"},[s._v("202")]),a("br"),a("span",{staticClass:"line-number"},[s._v("203")]),a("br"),a("span",{staticClass:"line-number"},[s._v("204")]),a("br"),a("span",{staticClass:"line-number"},[s._v("205")]),a("br"),a("span",{staticClass:"line-number"},[s._v("206")]),a("br"),a("span",{staticClass:"line-number"},[s._v("207")]),a("br"),a("span",{staticClass:"line-number"},[s._v("208")]),a("br"),a("span",{staticClass:"line-number"},[s._v("209")]),a("br"),a("span",{staticClass:"line-number"},[s._v("210")]),a("br"),a("span",{staticClass:"line-number"},[s._v("211")]),a("br"),a("span",{staticClass:"line-number"},[s._v("212")]),a("br"),a("span",{staticClass:"line-number"},[s._v("213")]),a("br"),a("span",{staticClass:"line-number"},[s._v("214")]),a("br"),a("span",{staticClass:"line-number"},[s._v("215")]),a("br"),a("span",{staticClass:"line-number"},[s._v("216")]),a("br"),a("span",{staticClass:"line-number"},[s._v("217")]),a("br"),a("span",{staticClass:"line-number"},[s._v("218")]),a("br"),a("span",{staticClass:"line-number"},[s._v("219")]),a("br"),a("span",{staticClass:"line-number"},[s._v("220")]),a("br"),a("span",{staticClass:"line-number"},[s._v("221")]),a("br"),a("span",{staticClass:"line-number"},[s._v("222")]),a("br"),a("span",{staticClass:"line-number"},[s._v("223")]),a("br"),a("span",{staticClass:"line-number"},[s._v("224")]),a("br"),a("span",{staticClass:"line-number"},[s._v("225")]),a("br"),a("span",{staticClass:"line-number"},[s._v("226")]),a("br"),a("span",{staticClass:"line-number"},[s._v("227")]),a("br"),a("span",{staticClass:"line-number"},[s._v("228")]),a("br"),a("span",{staticClass:"line-number"},[s._v("229")]),a("br"),a("span",{staticClass:"line-number"},[s._v("230")]),a("br"),a("span",{staticClass:"line-number"},[s._v("231")]),a("br"),a("span",{staticClass:"line-number"},[s._v("232")]),a("br"),a("span",{staticClass:"line-number"},[s._v("233")]),a("br"),a("span",{staticClass:"line-number"},[s._v("234")]),a("br"),a("span",{staticClass:"line-number"},[s._v("235")]),a("br"),a("span",{staticClass:"line-number"},[s._v("236")]),a("br"),a("span",{staticClass:"line-number"},[s._v("237")]),a("br"),a("span",{staticClass:"line-number"},[s._v("238")]),a("br"),a("span",{staticClass:"line-number"},[s._v("239")]),a("br"),a("span",{staticClass:"line-number"},[s._v("240")]),a("br")])]),a("p",[s._v("TODO 需要校正上述文本是否正确，在日常工作中进行分析研究。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除services")]),s._v("\n$ kubectl delete services nginx-service\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除deployments")]),s._v("\n$ kubectl delete deploy kubernetes-bootcamp\n$ kubectl delete deploy nginx-deployment\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停掉worker节点的服务")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kubelet stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fr")]),s._v(" /var/lib/kubelet/*\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-proxy stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fr")]),s._v(" /var/lib/kube-proxy/*\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-calico stop\n\nsystemctl stop kubelet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fr")]),s._v(" /var/lib/kubelet/*\nsystemctl stop kube-proxy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fr")]),s._v(" /var/lib/kube-proxy/*\nsystemctl stop kube-calico \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停掉master节点的服务")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-calico stop\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-scheduler stop\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-controller-manager stop\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-apiserver stop\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" etcd stop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-fr")]),s._v(" /var/lib/etcd/*\n\nkubectl run kubernetes-bootcamp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--image")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("jocatalin/kubernetes-bootcamp:v1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\nkubectl get pods\nkubectl logs kubernetes-bootcamp-6b7849c495-q27nd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看pods日志")]),s._v("\nkubectl describe pods kubernetes-bootcamp-6b7849c495-q27nd\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看pods配置")]),s._v("\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" kubernetes-bootcamp-6b7849c495-q27nd "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入pods")]),s._v("\nkubectl get serviceaccount\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看serviceaccount (简称sa)")]),s._v("\nkubectl get sa\nkubectl get sa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" yaml  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以yaml（也可以是json）格式输出sa配置")]),s._v("\nkubectl get secrets\nkubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" image pods nginx "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nginx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx:1.7.9\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改pods镜像")]),s._v("\n\napply 比create好的原因，是可以随便修改后生效\n\nkubectl run busybox "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--image")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("busybox "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Never "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tty")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以busybox创建一个终端")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/d84cdfe2ea86",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker 网络配置"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"harbor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#harbor"}},[s._v("#")]),s._v(" Harbor")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/goharbor/harbor/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("harbor下载地址"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-L")]),s._v(" https://github.com/docker/compose/releases/download/1.17.1/docker-compose-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/bin/docker-compose\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" harbor-online-installer-v1.9.2.tgz\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" harbor/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 将域名添加到当前hosts中，例如 192.168.2.109 my.harbor.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/hosts\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 修改配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" harbor.yml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 修改配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## hostname: my.harbor.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## harbor_admin_password: Harbor12345")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## database:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##    password: root123")]),s._v("\n\n./prepare\n./install.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 启动harbor")]),s._v("\n./docker-compose up "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 停止HarBor")]),s._v("\n./docker-compose down "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 管理界面")]),s._v("\nhttp://my.harbor.com\tadmin/Harbor12345\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step01: 创建用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## testuser\ttestuser@163.com testuser qazWSXedc123")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step02: 创建项目")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step03: 为项目分配成员")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step04: 配置其他机器host")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.2.109 my.harbor.com'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 修改docker配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /lib/systemd/system/docker.service\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 设置不安全地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" fd:// "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--containerd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock --insecure-registry my.harbor.com\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重启Docker")]),s._v("\nsystemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step05: 登录仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login my.harbor.com\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## step06： 重新标记镜像，并推送镜像至远程仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag nginx:1.7.9 my.harbor.com/micro-service/nginx:1.7.9\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push my.harbor.com/micro-service/nginx:1.7.9\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag yandex/clickhouse-server:latest registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-server:latest\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-server:latest\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag yandex/clickhouse-client:latest registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-client:latest\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-client:latest\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag spoonest/clickhouse-tabix-web-client:latest registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-tabix-web-client:latest\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-beijing.aliyuncs.com/dkgee/clickhouse-tabix-web-client:latest\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag elasticsearch:7.6.1 registry.cn-beijing.aliyuncs.com/dkgee/elasticsearch:7.6.1\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-beijing.aliyuncs.com/dkgee/elasticsearch:7.6.1\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br")])]),a("h3",{attrs:{id:"calico"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calico"}},[s._v("#")]),s._v(" Calico")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装")])]),s._v(" "),a("li",[a("p",[s._v("重启")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-calico start\njournalctl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" kube-calico\nsystemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kube-calico restart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" journalctl "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" kube-calico\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"查看状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看状态"}},[s._v("#")]),s._v(" 查看状态")]),s._v(" "),a("p",[s._v("calicoctl node status\nnetstat -natp|grep ESTABLISHED|grep 179\nnetstat -natp|grep ESTABLISHED|grep bird\nnetstat -natp|grep bird")]),s._v(" "),a("h4",{attrs:{id:"查看路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看路由"}},[s._v("#")]),s._v(" 查看路由")]),s._v(" "),a("p",[s._v("route\t\t# 路由表\ntraceroute\t# 跟踪路由\ntraceroute 49.233.170.108\ntraceroute 122.51.101.124\ntraceroute 122.51.173.59")]),s._v(" "),a("h4",{attrs:{id:"calico连接状况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calico连接状况"}},[s._v("#")]),s._v(" Calico连接状况")]),s._v(" "),a("p",[s._v("Connect(成功启动，正在连接中)\t\t\t\t\t\t\t\t autodetect"),a("br"),s._v("\nConnect Socket: Host is unreachable(其他主机ip不通)\t 172.21.0.12"),a("br"),s._v("\nActive Socket: Connection closed(其他主机网络有问题)\t\t 49.233.170.108"),a("br"),s._v("\nActive Socket: Connection refused(其他主机端口没开放)"),a("br"),s._v("\nActive Socket: Host is unreachable（其他主机ip不通，主节点上出现该问题）\t\tautodetect")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("https://zhuanlan.zhihu.com/p/47228920\n")])])]),a("h4",{attrs:{id:"linux查看网卡流量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux查看网卡流量"}},[s._v("#")]),s._v(" linux查看网卡流量")]),s._v(" "),a("p",[s._v("tcpdump -i eth0 src host 172.17.0.10")]),s._v(" "),a("h4",{attrs:{id:"calico-设置ip-in-ip模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calico-设置ip-in-ip模式"}},[s._v("#")]),s._v(" calico 设置IP-in-IP模式")]),s._v(" "),a("p",[s._v("calicoctl create -f ipPool-ipip-always.yaml"),a("br"),s._v("\ncalicoctl delete -f ipPool-ipip-always.yaml"),a("br"),s._v("\ncalicoctl get ipp -owide\t# 查看ipp段"),a("br"),s._v("\ncalicoctl delete ipPool 10.254.0.0/24\t# 删除相应的ipp段"),a("br"),s._v("\ncalicoctl get ipPool -o yaml\t\t# 查看ipPool"),a("br"),s._v("\nip a s\t\t\t# 查看本机 会给主机分配IP，去往其他节点是通过tunl0网卡转发的"),a("br"),s._v("\nip r s\t\t\t# 查看路由"),a("br"),s._v("\nroute -n")]),s._v(" "),a("p",[s._v("ipPool-ipip-always.yaml")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ipPool\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cidr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.0.0/16\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ipip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cross"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("subnet\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nat-outgoing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ipPool\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cidr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.254.0.0/24 \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ipip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nat-outgoing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h4",{attrs:{id:"calico-bgp模式总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calico-bgp模式总结"}},[s._v("#")]),s._v(" calico BGP模式总结")]),s._v(" "),a("p",[s._v("https://www.jianshu.com/p/dcad6d74e526")]),s._v(" "),a("ol",[a("li",[s._v("BGP模式总结：\n"),a("ul",[a("li",[s._v("BGP模式下，不会在服务器上创建tunl0，")]),s._v(" "),a("li",[s._v("路由转发功能是通过服务器的网卡对流量进行转发的")])])]),s._v(" "),a("li",[s._v("ipip-always模式，\n"),a("ul",[a("li",[s._v("会在每个节点上，都创建tunl0,")]),s._v(" "),a("li",[s._v("通过tunl0进行流量转发")])])]),s._v(" "),a("li",[s._v("混合ipip-bgp模式\n"),a("ul",[a("li",[s._v("有些节点创建tunl0, 有些节点不创建tunl0")]),s._v(" "),a("li",[s._v("通过tunl0和网卡进行流量转发")]),s._v(" "),a("li",[s._v("如果calico集群里，存在多个混合ipip-bgp模式资源对象的话，只有第一个创建的ipip-bgp资源对象有效，\n后面创建一直处于阻塞状态， 经测试，只有删除第一个后，第二个会自动创建的；\n"),a("ul",[a("li",[s._v("也就是说，在calico集群中，同一时刻只能是第一个ipPool资源对象有效")])])])])]),s._v(" "),a("li",[s._v("libnetwork插件负责从ipPool池里，获取IP，指定给docker容器的 )")])]),s._v(" "),a("h2",{attrs:{id:"docker网络通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker网络通信"}},[s._v("#")]),s._v(" Docker网络通信")]),s._v(" "),a("h3",{attrs:{id:"使用consul跨主机网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用consul跨主机网络"}},[s._v("#")]),s._v(" 使用consul跨主机网络")]),s._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/zhouzhifei/p/11987355.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker跨主机网络实践"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/bigberg/p/8521542.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker容器跨主机通信--overlay网络"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/jiangbenchu/article/details/102495531",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考关键词：networks driver overlay"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://c.biancheng.net/view/3176.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("推荐阅读：Docker Swarm简介"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("Docker跨主机通信需要key value的服务来保存网络的信息，这里使用consul服务作为key value的服务")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step01: 构建跨主机网络信息保存consul")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"always"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--publish")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8500:8500"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--hostname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"consul"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"consul"')]),s._v(" index.alauda.cn/sequenceiq/consul:v0.5.0-v6 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-bootstrap")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step02: 改造各台主机的Docker配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /lib/systemd/system/docker.service\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 添加如下配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## --cluster-store=consul://192.168.2.106:8500  # consul服务地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## --cluster-advertise=172.16.200.208:2375    # 加入集群后，广播的地址，也就是每台机器的实际IP地址，也可是是本机的网卡")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 修改后，其中结果如下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ExecStart=/usr/bin/dockerd  -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock --cluster-store=consul://192.168.2.106:8500 --cluster-advertise=192.168.2.106:2375")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 重新加载配置和重启docker容器。")]),s._v("\nsystemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看consul 中的节点信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## http://192.168.2.106:8500")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step03: 创建overlay网络　　")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" overlay multi_host\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network inspect multi_host\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" multi_host\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 创建子网络")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" overlay "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--subnet")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.30")]),s._v(".0.0/16 ctfx_net\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h3",{attrs:{id:"使用swam跨主机网络通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用swam跨主机网络通信"}},[s._v("#")]),s._v(" 使用swam跨主机网络通信")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/a906941d4377",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker跨主机的网络配置方法"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step01: 在master运行以下命令会产生token，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" swarm init \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step02: 使用token，在slave运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" swarm "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--token")]),s._v(" xxx  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.151:2377\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在主节点上使用以下命令查看节点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个swarm网络，docker容器之间可以加入到这个网络里实现互联互通")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" overlay "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--attachable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("网络名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在启动容器的时候，加入到刚刚创建的网络中就完成了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在master上运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" node1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("网络名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" debian "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在slave上运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" node2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--network")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("网络名"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" debian "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[s._v("#")]),s._v(" DNS")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/c9e376df7074",target:"_blank",rel:"noopener noreferrer"}},[s._v("基于Docker快速搭建DNS Server"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=t.exports}}]);