(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{476:function(t,s,a){"use strict";a.r(s);var n=a(36),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"分布式文件存储解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分布式文件存储解决方案"}},[t._v("#")]),t._v(" 分布式文件存储解决方案")]),t._v(" "),s("h3",{attrs:{id:"fastdfs技术方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fastdfs技术方案"}},[t._v("#")]),t._v(" FastDFS技术方案")]),t._v(" "),s("p",[t._v("推荐阅读")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/qq_40369435/article/details/91512431",target:"_blank",rel:"noopener noreferrer"}},[t._v("分布式海量文件存储--基于 Docker 来安装 FastDFS"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/yanwanglol/p/9860202.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用docker搭建FastDFS文件系统"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/taojin12/article/details/88380375",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用SpringBoot上传文件到FastDFS"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/ityouknow/p/8240976.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("分布式文件系统FastDFS详解"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/EFsK3yOtb7maDNqgaHjQow?",target:"_blank",rel:"noopener noreferrer"}},[t._v("一次FastDFS并发问题的排查经历"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/eer123/p/9218758.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring boot集成FastDFS文件上传下载"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/dkgee/spring-examples",target:"_blank",rel:"noopener noreferrer"}},[t._v("fastdfs-client-java|spring boot集成FastDFS文件示例"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/tobato/FastDFS_Client",target:"_blank",rel:"noopener noreferrer"}},[t._v("FastDFS_Client|spring boot集成FastDFS文件示例"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull delron/fastdfs\n \n "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" tracker "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /var/fdfs/tracker:/var/fdfs delron/fastdfs tracker\n \n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导入到其他系统后，重新tag")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" tag 8487e86fc6ee delron/fastdfs:latest\n \n "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("host "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" storage "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TRACKER_SERVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.30")]),t._v(".154.245:22122 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /var/fdfs/storage:/var/fdfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GROUP_NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("group1 delron/fastdfs storage\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Test")]),t._v(" "),s("p",[t._v("测试fastDFS是否支持图片(png)、文档（.sh、.txt、.xlsx、.ppt）、视频(imp4)格式是否支撑？"),s("br"),t._v("\n测试结果是支持，文件上传后，fastDFS会生成文件路径（生成随机文件名），并加上文件的后缀返回路径。浏览器打开该路径时，如果为脚本文件，则直接会下载。\n如果为图片则自动下载。"),s("a",{attrs:{href:"https://www.cnblogs.com/yanwanglol/p/9860202.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("本次测试环境安装参考"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("文件名：与文件上传时不同。是由存储服务器根据特定信息生成，文件名包含：源存储服务器IP地址、文件创建时间戳、文件大小、随机数和文件拓展名等信息。")]),t._v(" "),s("p",[t._v("http://172.30.154.243:8888/group1/M00/00/00/rB6a9l6mN22ADIniAA3dLbKPMHo644.png  节点一浏览器访问自动下载（各个storage节点都可以下载）\nhttp://172.30.154.244:8888/group1/M00/00/00/rB6a9l6mN22ADIniAA3dLbKPMHo644.png  节点二浏览器访问"),s("br"),t._v("\nhttp://172.30.154.246:8888/group1/M00/00/00/rB6a9l6mN22ADIniAA3dLbKPMHo644.png  节点三浏览器访问"),s("br"),t._v("\nhttp:😕/172.30.154.246:8888/group1/M00/00/00/rB6a9l6mOeuAZv_mAAAH7fDst5A6325.sh   浏览器自动下载"),s("br"),t._v("\nhttp:😕/172.30.154.246:8888/group1/M00/00/00/rB6a9l6mOfiAAGk5AAACFyspUjE.0.conf   浏览器自动下载"),s("br"),t._v("\nhttp:😕/172.30.154.246:8888/group1/M00/00/00/rB6a9l6mOf-Aam7HAAUsSuCCSEM17.pptx   浏览器自动下载"),s("br"),t._v("\nhttp:😕/172.30.154.246:8888/group1/M00/00/00/rB6a9l6mOgeAO4FzAAAiyps6ICQ64.xlsx   浏览器自动下载")])]),t._v(" "),s("p",[t._v("使用SpringBoot2.x集成FastDFS客户端后，删除服务器上文件发现，浏览器再次访问地址依然有效，并不是立即删除，而是过了几分钟后，再次访问则失效。\n尝试再次去删除该文件时，测试程序报错：“com.github.tobato.fastdfs.exception.FdfsServerException: 错误码：2，错误信息：找不到节点或文件”")]),t._v(" "),s("p",[t._v("SpringBoot2.x配置参考如下："),s("br"),t._v("\nstep01: POM配置")]),t._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- fastdfs-client-java --\x3e")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.github.tobato"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("fastdfs-client"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.26.5"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("exclusions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("exclusion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("ch.qos.logback"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("logback-classic"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("exclusion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("exclusions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("step02:  application.properties配置")]),t._v(" "),s("div",{staticClass:"language-property line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# fastFDS配置\nfdfs.so-timeout=1501\nfdfs.connect-timeout=601 \nfdfs.thumb-image.width=150\nfdfs.thumb-image.height=150\nfdfs.web-server-url=http://172.30.154.246:8888/\nfdfs.tracker-list=172.30.154.245:22122\nfdfs.pool.max-total=-1\nfdfs.pool.max-wait-millis=5000\nfdfs.pool.max-total-per-key=50\nfdfs.pool.max-idle-per-key=10\nfdfs.pool.min-idle-per-key=5\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("step03: FastDFSClient、FastDFSController参考"),s("a",{attrs:{href:"https://github.com/dkgee/SpringBoot2-FastDFS",target:"_blank",rel:"noopener noreferrer"}},[t._v("SpringBoot2-FastDFS"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("CountDownLatch")]),t._v(" "),s("p",[t._v("CountDownLatch可用于创建并发，在启动的过程中，创建一堆线程，并阻塞等待线程创建完成后，整体一起并发执行以模拟高并发业务场景。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);